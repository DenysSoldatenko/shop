<!DOCTYPE html>
<html>
<head>
  <title>Оформлення</title>
  <link rel="stylesheet" type="text/css" href="/assets/checkout.css">
</head>
<body>
<%= render "shared/navbar" %>
<div class="checkout-container">
  <div class="address-section">
    <h2>Замовлення</h2>

    <% @cart.carts_products.each do |carts_product| %>
      <% product = carts_product.product %>
      <div class="product-info">
        <span class="product-name">Продукт: <%= product.name %></span>
        <span>Ціна: <%= product.price %> грн</span>
        <span>Кількість: <%= carts_product.quantity %>
          <%= carts_product.quantity == 1 ? 'товар'
                : (2..4).include?(carts_product.quantity) ? 'товари' : 'товарів' %></span>
      </div>
    <% end %>

    <div class="total-amount">
      <span>Загальна сума: <%= @total %> грн</span>
    </div><br><br>

    <%= form_for(@user_address, url: address_create_path, method: :put) do |f| %>
        <% if flash[:alert] %>
          <div class="error-message" style="background-color: red; color: white; padding: 10px;">
            <%= flash[:alert] %><br />
          </div>
        <% end %>
        <h2>1) Доставка</h2>

        <div class="form-group">
          <%= f.label :address , "Адреса"%>
          <%= f.text_field :address, class: "form-control", id: "address-input" %>
          <% if @user_address.errors.has_key?(:address) %>
            <div class="error-message">
              <%= @user_address.errors[:address].first %>
            </div>
          <% end %>
        </div>

        <div class="form-group">
          <%= f.label :city , "Місто"%>
          <%= f.text_field :city, class: "form-control", id: "city-input" %>
          <% if @user_address.errors.has_key?(:city) %>
            <div class="error-message">
              <%= @user_address.errors[:city].first %>
            </div>
          <% end %>
        </div>

        <div class="form-group">
          <%= f.label :zip_code , "Поштовий код"%>
          <%= f.text_field :zip_code, class: "form-control", maxlength: 5, pattern: "[0-9]{5}" %>
          <% if @user_address.errors.has_key?(:zip_code) %>
            <div class="error-message">
              <%= @user_address.errors[:zip_code].first %>
            </div>
          <% end %>
        </div>

        <div class="form-group">
          <%= f.label :phone_number , "Телефонний номер"%>
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text">+38</span>
            </div>
            <%= f.text_field :phone_number, class: "form-control" %>
          </div>
        </div>

        <div class="form-group submit-section">
          <%= f.submit "Підтвердити", class: "btn btn-primary" %>
        </div>
    <% end %>
  </div>
</div>
</body>
</html>

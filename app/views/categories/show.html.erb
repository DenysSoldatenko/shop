<body>
<%= render "shared/navbar" %>
<span class="col bg-info"><%=link_to "Головна", root_path%>
  <%if @breadcrumbs != nil%>
      <%@breadcrumbs.reverse_each do |crumb|%>
        <%if crumb!=nil %>
          ><%= link_to crumb.name, category_path(id: crumb.id) %>
        <%end %>
      <% end %>
      <%end %>
    </span>
<h2><%=@category.name %></h2>
<div class="wrapper d-flex align-items-stretch">
  <nav class="bg-danger d-flex flex-column align-items-center" style="width: 20%">
    <% @children.each do |category| %>
      <%= link_to category.name, "#{category.id}", style: "font-size: 20px;"%>
    <% end %>
    <%= form_tag category_url, method: :get, name: "filters", class: "d-flex flex-column align-items-center" do |form| %>
      <%=select_tag(:select, options_for_select([["Спочатку дорогі", "price_desc"], ["Спочатку дешеві", "price_acs"], ["Кращий рейтинг", "rating_desc"]], @selected), :onchange => "javascript: document.filters.submit();" )%>
      <%=label_tag("price_from", "Ціна") %>
      <%=number_field_tag "price_from", @prices[0], min: 0, step: 0.01, :onchange => "javascript: document.filters.submit();" %>
      <%=label_tag("price_to", "-") %>
      <%=number_field_tag "price_to", @prices[1], min: 0, step: 0.01, :onchange => "javascript: document.filters.submit();"  %>
      <% @attributes.each do |attribute| %>
        <%if !attribute[2].empty? %>
          <h5><%= attribute[0] %></h5>
          <%attribute[2].each_with_index do |value, index| %>
            <div>
              <%=check_box_tag("#{attribute[1]}[#{index}]", "#{value[0]}", value[1], :onclick => "javascript: document.filters.submit();")%>
              <%=label_tag("#{attribute[1]}[#{index}]", "#{value[0]}")%>
            </div>
          <%end %>
        <%end %>
      <%end %>

    <%end %>
  </nav>
  <div class="bg-primary" style="width: 80%">
    <%i = 0 %>
    <%@products.each do |product| %>
      <%if i%4==0 && i!=0 %>
        </div>
      <%end %>
      <%if i%4==0 %>
        <div class="row bg-info mt-2 row-cols-4" style="margin: auto;">
      <%end %>
      <%= render 'products/product', product: product %>
      <%i+=1 %>
    <% end %>
  </div>
</div>
</div>

</body>
